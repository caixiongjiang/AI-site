# 文稿检查助手使用指南

## 🎯 功能概述

文稿检查助手是一个智能的文档合规性检查工具，支持：
- 📁 多文件/截图上传
- ✏️ 自定义检查项
- 🔍 智能校验
- 📊 可视化结果
- 📤 导出报告

## 🚀 快速开始

### 1. 访问页面
```
http://localhost:3000/agents/document-compliance
```

### 2. 上传文件（三种方式）

#### 方式 A：拖拽上传
1. 将文件拖拽到上传区域
2. 支持一次拖拽多个文件

#### 方式 B：点击选择
1. 点击"选择文件"按钮
2. 在文件选择器中选择一个或多个文件
3. 支持格式：PDF、图片、Word

#### 方式 C：粘贴截图 ✨
1. 使用系统截图工具截图
   - Windows: `Win + Shift + S`
   - Mac: `Cmd + Shift + 4`
2. 点击"粘贴截图"按钮
3. 系统自动读取剪贴板中的图片

### 3. 配置检查项（可选）

#### 使用默认规则
系统预设了 6 个检查项：
- 会议主持人（必填）
- 会议记录员（必填）
- 会议地点（必填）
- 会议时长（≤ 4小时）
- 缺席原因（条件必填）
- 实到人数（≥ 3人）

#### 添加自定义规则
1. 展开"检查项配置"面板
2. 点击"添加"按钮
3. 填写规则信息：
   - **规则名称**：显示名称（如"会议主题"）
   - **字段名**：后端字段名（如"topic"）
   - **类型**：必填项/数值/文本/时间/自定义
   - **必填字段**：勾选表示必填
   - **描述**：规则说明
4. 点击"保存"

#### 编辑规则
1. 点击规则右侧的编辑图标 ✏️
2. 修改信息
3. 点击"保存"

#### 删除规则
1. 点击规则右侧的删除图标 🗑️
2. 确认删除

### 4. 开始检查

1. 确保已上传至少一个文件
2. 选择是否"存入知识库"（可选）
3. 点击"开始检查"按钮
4. 等待处理完成（上传 → 解析 → 校验）

### 5. 查看结果

#### 统计概览
- **总计**：检查项总数
- **通过**：绿色，校验成功的项目
- **警告**：黄色，需要注意的项目
- **错误**：红色，必须修改的项目

#### 详细列表
每个检查项显示：
- 字段名称
- 状态标签（通过/警告/错误）
- 错误说明（如有）
- 原始值

### 6. 导出结果

#### 复制 AI 提示词
1. 点击"复制 AI 提示词"按钮
2. 提示词已复制到剪贴板
3. 可粘贴到外部 LLM（如 ChatGPT）进行深度校验

#### 导出检查报告
1. 点击"导出检查报告"按钮
2. 下载 TXT 格式报告
3. 报告包含：
   - 检查时间
   - 文件信息
   - 会议信息
   - 检查结果
   - 使用的检查规则

## 📋 检查规则说明

### 规则类型

| 类型 | 说明 | 示例 |
|------|------|------|
| **必填项** | 检查字段是否为空 | 主持人、记录员 |
| **数值** | 检查数值范围 | 人数 ≥ 3 |
| **文本** | 检查文本内容 | 缺席原因 |
| **时间** | 检查时间格式和范围 | 会议时长 |
| **自定义** | 自定义校验逻辑 | 复杂业务规则 |

### 严重程度

- 🟢 **成功**：字段符合要求
- 🟡 **警告**：建议检查但不强制
- 🔴 **错误**：必须修改的问题

## 💡 使用技巧

### 1. 批量上传
- 一次性上传多个文件可以节省时间
- 系统会依次处理所有文件

### 2. 截图快速检查
- 对于纸质文档，可以拍照或截图后直接粘贴
- 无需保存为文件

### 3. 自定义规则模板
- 为常用的检查场景创建规则模板
- 可以导出规则配置供团队使用

### 4. 结合外部 LLM
- 本地规则引擎处理基础校验（快速、安全）
- 导出提示词给 ChatGPT 做深度语义分析
- 两者结合获得最佳效果

## 🔧 常见问题

### Q: 支持哪些文件格式？
A: PDF、PNG、JPG、GIF、WebP、Word（.doc/.docx）

### Q: 文件大小限制是多少？
A: 每个文件最大 10MB

### Q: 可以同时上传多少个文件？
A: 前端无限制，建议单次不超过 10 个以保证性能

### Q: 截图粘贴不工作怎么办？
A: 
1. 确保浏览器支持剪贴板 API（Chrome 87+）
2. 检查是否授予了剪贴板权限
3. 使用"选择文件"作为备选方案

### Q: 检查规则会保存吗？
A: 当前版本规则保存在浏览器内存中，刷新页面会重置为默认规则。后续版本会支持规则持久化。

### Q: 如何与后端集成？
A: 参考 `components/agents/document-compliance/README.md` 中的后端接入指南

## 🎓 最佳实践

### 1. 规则设计
- 规则名称要清晰明确
- 字段名与后端保持一致
- 添加详细的描述说明

### 2. 文件准备
- 确保文件清晰可读
- 图片文件建议使用 PNG 格式
- 文档结构化程度越高，识别越准确

### 3. 结果处理
- 优先处理"错误"级别的问题
- "警告"项目需要人工判断
- 导出报告留存检查记录

## 📊 工作流程示例

### 场景：会议记录检查

1. **准备**
   - 会议结束后获取会议记录文档
   - 或者拍摄纸质记录的照片

2. **上传**
   - 拖拽文档到上传区域
   - 或粘贴截图

3. **配置**（首次使用）
   - 根据公司规范添加检查项
   - 如：会议主题、决议事项等

4. **检查**
   - 点击"开始检查"
   - 等待 10-30 秒

5. **审核**
   - 查看统计：是否有错误项
   - 逐项检查详细结果
   - 对于警告项进行人工判断

6. **修正**
   - 根据错误提示修改原文档
   - 重新上传检查

7. **归档**
   - 导出检查报告
   - 选择"存入知识库"
   - 完成流程

## 🔐 数据安全

- ✅ 默认不发送数据到外部 LLM
- ✅ 本地规则引擎处理敏感信息
- ✅ 可选的知识库存储
- ✅ 提示词导出供用户自主选择

## 📞 技术支持

- 📖 组件文档：`components/agents/document-compliance/README.md`
- 🏗️ 架构文档：`docs/AGENT_ARCHITECTURE.md`
- 📋 需求文档：`document_compliance.md`

## 🎉 总结

文稿检查助手通过智能化的方式帮助您：
- ⚡ 快速发现文档问题
- 🎯 确保合规性
- 📈 提高工作效率
- 🔒 保护数据安全

开始使用，让文档检查变得简单高效！
